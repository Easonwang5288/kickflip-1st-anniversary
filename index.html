<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Kickflip 1st Anniversary Quiz</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* --- v6.1 æ¨£å¼è¨­è¨ˆ --- */
        :root {
            --primary-color: #FF5A5F;
            --accent-color: #FF8E92;
            --bg-color: #F7F8FA;
            --card-bg: rgba(255, 255, 255, 0.95);
            --text-dark: #333333;
            --text-light: #666666;
            --shadow: 0 8px 30px rgba(0,0,0,0.12);
        }

        body {
            font-family: 'Noto Sans KR', 'Noto Sans TC', sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #fdfbfb 0%, #ebedee 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: var(--text-dark);
        }

        .app-container {
            width: 100%;
            max-width: 420px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .card {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-radius: 24px;
            margin: 20px;
            padding: 30px 20px;
            /* ç‚ºäº†çµ¦ä¸‹æ–¹æŒ‰éˆ•ç•™ç©ºé–“ï¼Œç¨å¾®å¢åŠ  padding-bottom */
            padding-bottom: 50px; 
            box-shadow: var(--shadow);
            text-align: center;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
            overflow: hidden;
        }

        .watermark {
            position: absolute;
            bottom: 8px;
            right: 12px;
            font-size: 11px;
            color: rgba(0, 0, 0, 0.2);
            font-weight: bold;
            z-index: 5;
            pointer-events: none;
            font-family: sans-serif;
            letter-spacing: 0.5px;
        }

        /* --- æ§åˆ¶åˆ— (éŸ³æ¨‚/èªè¨€) --- */
        .top-bar {
            position: absolute;
            top: 20px;
            left: 0;
            width: 100%;
            display: flex;
            justify-content: space-between; /* å·¦å³åˆ†ä½ˆ */
            align-items: center;
            padding: 0 20px;
            box-sizing: border-box;
            z-index: 10;
        }

        /* â˜…â˜…â˜… æ–°å¢ï¼šå·¦ä¸‹è§’ä¸Šä¸€é¡ŒæŒ‰éˆ•æ¨£å¼ â˜…â˜…â˜… */
        .back-btn {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid #ddd;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            color: var(--text-light);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            z-index: 20;
            display: none; /* é è¨­éš±è— */
            transition: all 0.2s;
        }
        .back-btn:active {
            transform: scale(0.95);
            background: #f0f0f0;
        }

        /* éŸ³æ¨‚æŒ‰éˆ• */
        .music-btn {
            background: rgba(255,255,255,0.8);
            border: 1px solid #ddd;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            font-size: 14px;
            cursor: pointer;
            color: var(--text-light);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            transition: 0.2s;
        }
        .music-btn.playing {
            color: var(--primary-color);
            border-color: var(--primary-color);
            animation: spin 4s linear infinite;
        }
        @keyframes spin { 100% { transform: rotate(360deg); } }

        /* èªè¨€æŒ‰éˆ•ç¾¤çµ„ */
        .lang-group {
            display: flex;
            gap: 5px;
        }
        .lang-btn {
            background: rgba(255,255,255,0.8);
            border: 1px solid #ddd;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            cursor: pointer;
            color: var(--text-light);
            transition: 0.2s;
        }
        .lang-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
            font-weight: bold;
        }

        h1 {
            font-size: 26px;
            margin-bottom: 10px;
            margin-top: 0;
            color: var(--primary-color);
            letter-spacing: -0.5px;
        }
        p {
            font-size: 15px;
            color: var(--text-light);
            line-height: 1.6;
        }

        .progress-bar-container {
            width: 100%;
            height: 6px;
            background: #eee;
            border-radius: 10px;
            margin-bottom: 20px;
            overflow: hidden;
            display: none;
        }
        .progress-bar {
            height: 100%;
            background: var(--primary-color);
            width: 0%;
            transition: width 0.3s ease;
        }

        /* é¸é …æŒ‰éˆ•å®¹å™¨ */
        #options-container {
            width: 100%;
            /* ç”¨æ–¼é˜²æ­¢é€£é»çš„æ¨£å¼ */
            transition: opacity 0.2s; 
        }

        .btn {
            width: 100%;
            padding: 16px 20px;
            margin: 8px 0;
            background: white;
            border: 2px solid #f0f0f0;
            border-radius: 16px;
            font-size: 15px;
            color: var(--text-dark);
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: left;
            position: relative;
            box-shadow: 0 2px 5px rgba(0,0,0,0.02);
            user-select: none; 
            -webkit-tap-highlight-color: transparent;
        }
        /* ç•¶è¢«é¸ä¸­æ™‚çš„æ¨£å¼ */
        .btn.selected {
            border-color: var(--primary-color);
            background: #fff5f5;
            transform: scale(0.98);
        }
        .btn:hover {
            border-color: var(--accent-color);
        }
        
        #start-btn, #restart-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            text-align: center;
            font-weight: bold;
            font-size: 18px;
            box-shadow: 0 4px 15px rgba(255, 90, 95, 0.4);
            margin-top: 20px;
        }

        #start-logo {
            width: 180px;
            height: auto;
            margin-bottom: 25px;
        }

        #question-img {
            width: 100%;
            max-height: 250px;
            object-fit: cover;
            border-radius: 16px;
            margin-bottom: 15px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            display: none;
        }
        
        #result-img {
            width: 100%;
            border-radius: 16px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
            margin: 15px 0;
            display: block;
            border: 4px solid white;
        }

        .hidden { display: none !important; }
        .fade-in { animation: fadeIn 0.5s forwards; }
        .slide-up { animation: slideUp 0.5s forwards; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        
        .footer {
            font-size: 12px;
            color: #ccc;
            margin-top: auto;
            padding-bottom: 20px;
            text-align: center;
        }
    </style>
</head>
<body>

<div class="app-container">
    <div class="card slide-up">
        <div class="watermark">@weflip.0526</div>

        <button class="back-btn" id="back-btn" onclick="prevQuestion()">
            &lt; Back
        </button>

        <div class="top-bar">
            <button class="music-btn" onclick="toggleMusic()" id="music-btn">ğŸµ</button>
            <audio id="bgm" src="bgm.mp3" loop></audio>

            <div class="lang-group">
                <button class="lang-btn active" onclick="setLang('zh', this)">ä¸­</button>
                <button class="lang-btn" onclick="setLang('kr', this)">í•œ</button>
                <button class="lang-btn" onclick="setLang('en', this)">EN</button>
            </div>
        </div>

        <div class="progress-bar-container" id="progress-container">
            <div class="progress-bar" id="progress-fill"></div>
        </div>

        <div id="start-screen">
            <img id="start-logo" src="logo.png" alt="Kickflip Logo" class="fade-in">
            <h1 id="title-text">è®“æˆ‘å€‘è·Ÿ Kickflip ä¸€èµ·æ­¡åº¦ä¸€å‘¨å¹´å§</h1>
            <p id="subtitle-text">æ¸¬é©—å‡ºä½ åœ¨ Kickflip è£¡çš„å‘½å®šå¤¥ä¼´ï¼</p>
            <button class="btn" onclick="startQuiz()" id="start-btn">é–‹å§‹æ¸¬é©—</button>
        </div>

        <div id="quiz-screen" class="hidden">
            <img id="question-img" src="" alt="Question Image" class="fade-in">
            <h2 id="question-text" style="font-size: 20px; margin-bottom: 20px; color:#333;">é¡Œç›®è¼‰å…¥ä¸­...</h2>
            <div id="options-container"></div>
        </div>

        <div id="result-screen" class="hidden">
            <h2 id="result-title" style="color:var(--primary-color);">ä½ çš„å‘½å®šæˆå“¡æ˜¯...</h2>
            <img id="result-img" src="" alt="Result Card">
            <p id="result-desc" style="font-weight:bold; font-size:18px; margin:10px 0; white-space: pre-line;"></p>
            <p style="font-size: 0.85em; color: #999; background:#f5f5f5; padding:5px 10px; border-radius:20px; display:inline-block;" id="save-hint">é•·æŒ‰åœ–ç‰‡å³å¯å„²å­˜å°å¡</p>
            <button class="btn" onclick="location.reload()" id="restart-btn">å†æ¸¬ä¸€æ¬¡</button>
        </div>
    </div>

    <div class="footer">
        Â© Kickflip 1st Anniversary Fan Project
    </div>
</div>

<script>
    /* --- è³‡æ–™è¨­å®šå€ --- */
    const texts = {
        zh: {
            title: "Kickflip ä¸€é€±å¹´ç´€å¿µ",
            subtitle: "æ¸¬é©—å‡ºä½ åœ¨ Kickflip è£¡çš„å‘½å®šå¤¥ä¼´ï¼",
            start: "é–‹å§‹æ¸¬é©—",
            resultTitle: "ä½ çš„å‘½å®šæˆå“¡æ˜¯...",
            saveHint: "é•·æŒ‰åœ–ç‰‡å³å¯å„²å­˜å°å¡ (å†æ¸¬ä¸€æ¬¡ä¹Ÿè¨±æœƒæœ‰ä¸åŒå°å¡å–”!)", 
            restart: "å†ç©ä¸€æ¬¡",
            back: "< ä¸Šä¸€é¡Œ",
            questions: [
                {
                    q: "Q1.ã€ç”Ÿå­˜æƒ…å¢ƒã€‘å¦‚æœä¸å¹¸æµè½åˆ°ç„¡äººå³¶ï¼Œåªèƒ½å¸¶ä¸€ä½æˆå“¡ï¼Œä½ æœƒé¸æ“‡å…·å‚™ç”šéº¼æŠ€èƒ½çš„æˆå“¡ï¼Ÿ",
                    opts: ["A. æŒ–æ´ ", "B. ç‹©çµ ", "C. æ­å»º/ç”Ÿç« ", "D. æ–™ç† ", "E. èººå¹³/è² è²¬åƒ "]
                },
                {
                    q: "Q2.ã€æ ¡åœ’æƒ…å¢ƒã€‘æ–°å­¸æœŸæ›åº§ä½ï¼Œå¦‚æœå¯ä»¥è‡ªå·±é¸æ“‡ï¼Œä½ æœ€å¸Œæœ›ä½ çš„ã€ŒåŒæ¡Œã€æ˜¯å“ªç¨®é¡å‹ï¼Ÿ",
                    opts: ["A. ä¸Šèª²å·å·å‚³ç´™æ¢ã€ä¸€èµ·åƒé›¶é£Ÿ", "B. ç­†è¨˜è¶…å®Œç¾çš„å­¸éœ¸ï¼Œè€ƒè©¦ç¥éšŠå‹", "C. é»˜é»˜å¹«ä½ æ“‹é™½å…‰ã€å€Ÿæ–‡å…·çš„æš–ç”·", "D. é«”è‚²èª²Carryå…¨å ´ï¼Œä¿è­·ä½ çš„æ ¡éœ¸"]
                },
                {
                    q: "Q3.ã€æ—…è¡Œæƒ…å¢ƒã€‘Kickflip ä¸€é€±å¹´äº†ï¼å¦‚æœæˆå“¡é‚€è«‹ä½ å»ä¸‰å¤©å…©å¤œçš„æ—…è¡Œï¼Œä½ æœ€æœŸå¾…å“ªç¨®è¡Œç¨‹ï¼Ÿ",
                    opts: ["A. æ²’è¡Œç¨‹ï¼Œç¡åˆ°è‡ªç„¶é†’ï¼Œéš¨æ„åƒå–æ‹ç…§", "B. åˆºæ¿€æ´»å‹•ï¼é«˜ç©ºå½ˆè·³ã€è¡æµªã€éŠæ¨‚åœ’", "C. æº«é¦¨è·¯ç·šï¼Œä¸€èµ·è²·èœç…®ç«é‹ã€ç©æ¡ŒéŠ"]
                },
                {
                    q: "Q4.ã€å±æ©Ÿæƒ…å¢ƒã€‘è¿·è·¯äº†æ‰‹æ©Ÿåˆå¿«æ²’é›»ï¼Œè·Ÿå“ªä½æˆå“¡åœ¨ä¸€èµ·ä½ æœƒæœ€å®‰å¿ƒï¼Ÿ",
                    opts: ["A. é›–ç„¶ä¹Ÿè¿·è·¯ï¼Œä½†ç‰½è‘—ä½ çš„æ‰‹èªªã€Œåˆ¥æ€•ã€", "B. ç«‹åˆ»æ‹¿åœ°åœ–æˆ–çœ‹å¤ªé™½è¾¨ä½çš„å¯é æ´¾", "C. å®Œå…¨ä¸ç·Šå¼µï¼Œæ‹‰è‘—ä½ å»è²·å†°æ·‡æ·‹çš„æ¨‚å¤©æ´¾"]
                },
                {
                    q: "Q5.ã€å…¥å‘ç¬é–“ã€‘é€™ä¸€å¹´ä¾†ï¼ŒKickflip æœ€è®“ä½ ã€Œå…¥å‘ã€çš„ç¬é–“æ˜¯ï¼Ÿ",
                    opts: ["A. èˆå°ä¸Šæ®ç‘æ±—æ°´ã€çœ¼ç¥å……æ»¿æ®ºæ°£", "B. ç›´æ’­æ™‚è·Ÿç²‰çµ²äº’æ‡Ÿã€èŠå¿ƒäº‹çš„çœŸèª ", "C. ç°½å”®æœƒä¸Šæº«æŸ”æ³¨è¦–ã€è¨˜å¾—ç²‰çµ²åå­—"]
                }
            ]
        },
        kr: {
            title: "í‚¥í”Œë¦½ 1ì£¼ë…„, ìš°ë¦¬ í•¨ê»˜ ì¶•í•˜í•´ìš”!",
            subtitle: "ë‹¹ì‹ ì˜ ìš´ëª…ì˜ ë©¤ë²„ëŠ” ëˆ„êµ¬ì¼ê¹Œìš”?",
            start: "ì‹œì‘í•˜ê¸°",
            resultTitle: "ë‹¹ì‹ ì˜ ìš´ëª…ì˜ ë©¤ë²„ëŠ”...",
            saveHint: "ì´ë¯¸ì§€ë¥¼ ê¸¸ê²Œ ëˆŒëŸ¬ ì €ì¥í•˜ì„¸ìš” (ë‹¤ì‹œ í•˜ë©´ ë‹¤ë¥¸ ì¹´ë“œê°€ ë‚˜ì˜¬ì§€ë„?)",
            restart: "ë‹¤ì‹œ í•˜ê¸°",
            back: "< ì´ì „",
            questions: [
                {
                    q: "Q1. [ìƒì¡´ìƒí™©] ë§Œì•½ ë¬´ì¸ë„ì— í‘œë¥˜í•œë‹¤ë©´, ì–´ë–¤ ëŠ¥ë ¥ì„ ê°€ì§„ ë©¤ë²„ë¥¼ ì„ íƒí•˜ê² ìŠµë‹ˆê¹Œ?",
                    opts: ["A. êµ´íŒŒê¸° ", "B. ì‚¬ëƒ¥ ", "C. ì„¸ì›€/ë¶ˆ í”¼ìš°ê¸° ", "D. ìš”ë¦¬ ", "E. ëˆ•ë°© ë‹´ë‹¹ "]
                },
                {
                    q: "Q2. [ìº í¼ìŠ¤] ìƒˆ í•™ê¸° ìë¦¬ ë°°ì¹˜! ë‹¹ì‹ ì´ ì›í•˜ëŠ” 'ì§ê¿' ìœ í˜•ì€?",
                    opts: ["A. ëª°ë˜ ìª½ì§€ ë³´ë‚´ê³  ê°„ì‹ ë‚˜ëˆ  ë¨¹ëŠ” ì¹œêµ¬", "B. í•„ê¸° ì™„ë²½! ì‹œí—˜ ê¸°ê°„ êµ¬ì„¸ì£¼ì¸ ëª¨ë²”ìƒ", "C. ë¬µë¬µíˆ í–‡ë¹› ë§‰ì•„ì£¼ê³  ì§€ìš°ê°œ ë¹Œë ¤ì£¼ëŠ” í›ˆë‚¨", "D. ì²´ìœ¡ ì‹œê°„ í•˜ë“œìºë¦¬! ë“ ë“ í•œ í•™êµ ì§±"]
                },
                {
                    q: "Q3. [ì—¬í–‰] í‚¥í”Œë¦½ 1ì£¼ë…„ ì—¬í–‰! ì–´ë–¤ ì¼ì •ì´ ê°€ì¥ ê¸°ëŒ€ë˜ë‚˜ìš”?",
                    opts: ["A. ê³„íš NO! ëŠ¦ì  ìê³  ë§›ì§‘ íƒë°© & ì¸ìƒìƒ·", "B. ìŠ¤ë¦´ ë§Œì ! ë²ˆì§€ì í”„, ì„œí•‘, ë†€ì´ê³µì›", "C. ì•„ëŠ‘í•œ ì½”ìŠ¤, ë§ˆíŠ¸ ì¥ë³´ê¸° & ë³´ë“œê²Œì„"]
                },
                {
                    q: "Q4. [ìœ„ê¸°] ê¸¸ì„ ìƒê³  ë°°í„°ë¦¬ë„ ì—†ì„ ë•Œ, ê°€ì¥ ì•ˆì‹¬ë˜ëŠ” ë©¤ë²„ëŠ”?",
                    opts: ["A. ì† ì¡ê³  'ê±±ì • ë§ˆ, ë‚´ê°€ ìˆì–ì•„' í•´ì£¼ëŠ” ë©¤ë²„", "B. ì§€ë„ë‚˜ íƒœì–‘ì„ ë³´ê³  ê¸¸ì„ ì°¾ëŠ” ë“ ë“ í•œ ë©¤ë²„", "C. ê¸´ì¥ê° ì œë¡œ! ì•„ì´ìŠ¤í¬ë¦¼ ì‚¬ëŸ¬ ê°€ìëŠ” ê¸ì •ì™•"]
                },
                {
                    q: "Q5. [ì…ë•] ì§€ë‚œ 1ë…„, í‚¥í”Œë¦½ì—ê²Œ ê±°í•˜ê²Œ 'ì…ë•'í•´ë²„ë¦° ìˆœê°„ì€?",
                    opts: ["A. ë¬´ëŒ€ ìœ„ ë•€ë°©ìš¸, ì¹´ë¦¬ìŠ¤ë§ˆ ë„˜ì¹˜ëŠ” ëˆˆë¹›", "B. ë¼ë°©ì—ì„œ ì¹œêµ¬ì²˜ëŸ¼ í‹°ê²©íƒœê²©í•˜ëŠ” ì§„ì†”í•¨", "C. ë‹¤ì •í•œ ëˆˆë¹›ìœ¼ë¡œ ì´ë¦„ ê¸°ì–µí•´ì£¼ëŠ” ë‹¤ì •í•¨"]
                }
            ]
        },
        en: {
            title: "Kickflip's 1st Anniversary!",
            subtitle: "Find out who your destined partner is!",
            start: "Start Quiz",
            resultTitle: "Your destined member is...",
            saveHint: "Long press image to save (Try again for a different card!)",
            restart: "Play Again",
            back: "< Back",
            questions: [
                {
                    q: "Q1. [Survival] Stranded on an island, which skill would you choose in a partner?",
                    opts: ["A. Digging ", "B. Hunting ", "C. Building/Fire ", "D. Cooking ", "E. Just chilling "]
                },
                {
                    q: "Q2. [Campus] New semester! Which seatmate do you want?",
                    opts: ["A. Secretly passing notes & snacking.", "B. Perfect note-taker who saves your grades.", "C. Warm guy always gets what you need.", "D. Athletic ace who protects you."]
                },
                {
                    q: "Q3. [Travel] Kickflip trip! Which itinerary do you prefer?",
                    opts: ["A. No plans, sleeping in, food & photos.", "B. Thrilling: Bungee, surfing, parks.", "C. Cozy: Grocery shopping, hotpot, games."]
                },
                {
                    q: "Q4. [Crisis] Lost with no battery. Who makes you safe?",
                    opts: ["A. Holds hand saying 'Don't worry'.", "B. Reliable navigator with a map.", "C. Optimist who buys ice cream instead."]
                },
                {
                    q: "Q5. [Fan Moment] The moment of falling in love with Kickflip?",
                    opts: ["A. Charismatic gaze on stage.", "B. Playful bickering on live stream.", "C. Warmly remembering fans' names."]
                }
            ]
        }
    };

    const questionImages = ["q1.jpg", "q2.jpg", "q3.jpg", "q4.jpg", "q5.jpg"];

    const members = [
        { id: 'A', name: "Lee Gye Hun", imgs: ["member_a_01.jpg", "member_a_02.jpg"], desc: "Reliable Leader\nåƒéšŠé•·ä¸€æ¨£ï¼Œä½ éœ€è¦ä¸€å€‹èƒ½å¸¶é ˜ä½ å‰é€²çš„å¯é å¤¥ä¼´ï¼" },
        { id: 'B', name: "Mitsuyuki Amaru", imgs: ["member_b_01.jpg", "member_b_02.jpg"], desc: "Persistent & Artistic\nåƒäºä¸¸ä¸€æ¨£ï¼Œå …æŒåˆ°åº•çš„è—è¡“å®¶éˆé­‚æœ€å¸å¼•ä½ ï¼" },
        { id: 'C', name: "Lee Dong Hwa", imgs: ["member_c_01.jpg", "member_c_02.jpg"], desc: "Witty & Smart\nåƒæ±èŠ±ä¸€æ¨£ï¼Œæ©Ÿæ™ºå¹½é»˜åˆè°æ˜çš„ç”·å­©æ˜¯ä½ çš„å¤©èœï¼" },
        { id: 'D', name: "Jang Ju Wang", imgs: ["member_d_01.jpg", "member_d_02.jpg"], desc: "Main Vocal & Foodie\nåƒä¸»æ±ªä¸€æ¨£ï¼Œèƒ½é™ªä½ åƒéç¾é£Ÿã€å”±æƒ…æ­Œçµ¦ä½ è½çš„ä»–æ˜¯æœ€æ£’çš„ï¼" },
        { id: 'E', name: "Choi Min Je", imgs: ["member_e_01.jpg", "member_e_02.jpg"], desc: "Shy & Loyal\nåƒæ—»å¸ä¸€æ¨£ï¼Œå®³ç¾å»å¿ èª çš„å¤§ç‹—ç‹—å‹ç”·å‹æœ€è®“ä½ å¿ƒå‹•ï¼" },
        { id: 'F', name: "Okamoto Keiju", imgs: ["member_f_01.jpg", "member_f_02.jpg"], desc: "Cute & Cat-like\nåƒä½³æ¨¹ä¸€æ¨£ï¼Œæœ‰é»å‚²å¬Œä½†è¶…ç´šå¯æ„›çš„è²“å’ªç³»ç”·å­©ï¼" },
        { id: 'G', name: "Lee Dong Hyeon", imgs: ["member_g_01.jpg", "member_g_02.jpg"], desc: "Sporty Maknae\nåƒæ±ç¹ä¸€æ¨£ï¼Œå……æ»¿æ´»åŠ›çš„é‹å‹•å°‘å¹´èƒ½å¸¶çµ¦ä½ æ»¿æ»¿èƒ½é‡ï¼" }
    ];

    const logic = [
        [[1], [6, 0], [2, 4], [3], [5]], 
        [[2, 3], [1, 0], [4], [6, 5]], 
        [[3, 5], [6, 2], [4, 0, 1]], 
        [[0, 4], [1, 2], [5, 3]], 
        [[5, 6], [2, 0], [4, 1]] 
    ];

    /* --- é‚è¼¯æ§åˆ¶å€ --- */
    let currentLang = 'zh';
    let currentQ = 0;
    const totalQ = 5;
    let userAnswers = [-1, -1, -1, -1, -1];
    
    // â˜… é˜²æ­¢é€£é»é–
    let isTransitioning = false; 

    const bgm = document.getElementById('bgm');
    bgm.volume = 0.5; 

    function toggleMusic() {
        const btn = document.getElementById('music-btn');
        if (bgm.paused) {
            bgm.play().then(() => {
                btn.classList.add('playing');
                btn.innerHTML = 'ğŸµ'; 
            }).catch(e => console.log("ç­‰å¾…äº’å‹•æ‰èƒ½æ’­æ”¾"));
        } else {
            bgm.pause();
            btn.classList.remove('playing');
        }
    }

    function setLang(lang, btnElement) {
        currentLang = lang;
        document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
        if(btnElement) btnElement.classList.add('active');
        
        document.getElementById('title-text').innerText = texts[lang].title;
        document.getElementById('subtitle-text').innerText = texts[lang].subtitle;
        document.getElementById('start-btn').innerText = texts[lang].start;
        document.getElementById('result-title').innerText = texts[lang].resultTitle;
        document.getElementById('save-hint').innerText = texts[lang].saveHint;
        document.getElementById('restart-btn').innerText = texts[lang].restart;
        document.getElementById('back-btn').innerText = texts[lang].back; 
        
        if (!document.getElementById('quiz-screen').classList.contains('hidden')) {
            renderQuestionContent();
        }
    }

    function startQuiz() {
        const musicBtn = document.getElementById('music-btn');
        bgm.play().then(() => {
            // â˜… ä¿®æ”¹ï¼šå¾ 25 ç§’é–‹å§‹æ’­æ”¾
            bgm.currentTime = 25; 
            musicBtn.classList.add('playing');
        }).catch(e => {
            console.log("ç€è¦½å™¨é˜»æ“‹è‡ªå‹•æ’­æ”¾");
        });

        document.getElementById('start-screen').classList.add('hidden');
        document.getElementById('quiz-screen').classList.remove('hidden');
        document.getElementById('progress-container').style.display = 'block';
        currentQ = 0;
        userAnswers = [-1, -1, -1, -1, -1];
        isTransitioning = false;
        updateProgress();
        showQuestion();
    }

    function updateProgress() {
        const percentage = ((currentQ) / totalQ) * 100;
        document.getElementById('progress-fill').style.width = percentage + '%';
    }

    function showQuestion() {
        // è§£é™¤æŒ‰éˆ•é–å®š
        isTransitioning = false;
        const optsContainer = document.getElementById('options-container');
        optsContainer.style.pointerEvents = 'auto'; // æ¢å¾©å¯é»æ“Š

        const backBtn = document.getElementById('back-btn');
        if (currentQ > 0) {
            backBtn.style.display = 'block';
        } else {
            backBtn.style.display = 'none';
        }

        const qDiv = document.getElementById('quiz-screen');
        qDiv.classList.remove('slide-up');
        void qDiv.offsetWidth; 
        qDiv.classList.add('slide-up');

        renderQuestionContent();
        document.getElementById('progress-fill').style.width = ((currentQ + 1) / totalQ * 100) + '%';
    }

    function renderQuestionContent() {
        const qData = texts[currentLang].questions[currentQ];
        
        const qImg = document.getElementById('question-img');
        qImg.src = questionImages[currentQ]; 
        qImg.style.display = 'block';

        document.getElementById('question-text').innerText = qData.q;
        const optsContainer = document.getElementById('options-container');
        optsContainer.innerHTML = '';

        qData.opts.forEach((opt, idx) => {
            const btn = document.createElement('button');
            btn.className = 'btn';
            btn.innerText = opt;
            
            if (userAnswers[currentQ] === idx) {
                btn.classList.add('selected');
            }

            btn.onclick = (e) => handleAnswer(idx, e.target);
            optsContainer.appendChild(btn);
        });
    }

    function handleAnswer(choiceIdx, btnElement) {
        // â˜… é˜²æ­¢é‡è¤‡é»æ“Šçš„é—œéµé‚è¼¯
        if (isTransitioning) return;
        isTransitioning = true; // é–å®š

        // é–å®šæ•´å€‹å®¹å™¨ï¼Œç¦æ­¢å†æ¬¡é»æ“Šä»»ä½•æŒ‰éˆ•
        document.getElementById('options-container').style.pointerEvents = 'none';

        const allBtns = document.getElementById('options-container').querySelectorAll('.btn');
        allBtns.forEach(b => b.classList.remove('selected'));
        btnElement.classList.add('selected');

        userAnswers[currentQ] = choiceIdx;

        // å»¶é²è·³è½‰
        setTimeout(() => {
            nextQuestion();
        }, 300);
    }

    function nextQuestion() {
        currentQ++;
        if (currentQ < totalQ) {
            showQuestion();
        } else {
            calculateAndShowResult();
        }
    }

    function prevQuestion() {
        // å¦‚æœæ­£åœ¨éå ´ä¸­ï¼Œä¸å…è¨±è¿”å›ï¼Œé¿å…é‚è¼¯æ‰“æ¶
        if (isTransitioning) return;
        
        if (currentQ > 0) {
            currentQ--;
            showQuestion();
        }
    }

    function calculateAndShowResult() {
        document.getElementById('quiz-screen').classList.add('hidden');
        document.getElementById('progress-container').style.display = 'none';
        document.getElementById('back-btn').style.display = 'none';
        document.getElementById('result-screen').classList.remove('hidden');

        let finalScores = [0, 0, 0, 0, 0, 0, 0];
        for (let qIdx = 0; qIdx < totalQ; qIdx++) {
            const choice = userAnswers[qIdx];
            if (choice !== -1) { 
                const pointsToAdd = logic[qIdx][choice];
                if (pointsToAdd) {
                    pointsToAdd.forEach(memberId => {
                        finalScores[memberId]++;
                    });
                }
            }
        }

        let maxScore = -1;
        let winners = [];
        for(let i=0; i<7; i++) {
            if (finalScores[i] > maxScore) {
                maxScore = finalScores[i];
                winners = [i];
            } else if (finalScores[i] === maxScore) {
                winners.push(i);
            }
        }
        const winnerIdx = winners[Math.floor(Math.random() * winners.length)];
        const resultMember = members[winnerIdx];
        const randomImg = resultMember.imgs[Math.floor(Math.random() * resultMember.imgs.length)];

        document.getElementById('result-img').src = randomImg;
        document.getElementById('result-desc').innerText = resultMember.name + "\n" + resultMember.desc;
        
        document.getElementById('result-img').onerror = function() {
            this.style.display = 'none';
            document.getElementById('result-desc').innerText += "\n(åœ–ç‰‡å°šæœªæº–å‚™å¥½: " + randomImg + ")";
        };
    }
</script>

</body>
</html>
